<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no"/>
    <title>jsx实现虚拟dom</title>
    <!--<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>-->
    <!--<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>-->
    <script src="js/babel.min.js"></script>
</head>
<body>
<div id="output"></div>
<script>
    function demo(){
        //es5转真实数组
        // console.log(Array.prototype.slice.call(arguments));
        //es6转真实数组
        // console.log(Array.from(arguments));
    }
    // demo(1,2,3,4)

    // let getArr=(...args)=>{
    //     console.log(args);
    // };
    // getArr(1,2,3,4);
    // var str1="1";
    // var str2="2";
    // var str3="3";
    // console.log([].concat(str1,str2,str3));
</script>
<script type="text/babel">
    /*@jsx createElement*/ //@jsx babel的自执行指令
    let users=[
        {name:"张三"},
        {name:"李四"},
        {name:"王五"}
    ];
    let vDom=(<div id="app" name="app">
        hello world!
        <ul>
            {
                users.map((item,index)=>{
                    return (
                        <li key={index}>{item.name}</li>
                    )
                })
            }
        </ul>
    </div>);
    // let vDom=("hello world! ");
    /*
    将真实的dom转成虚拟dom，json格式开销小，性能高
    {
        nodeName:div,
        attr:{
            id:"app"
        },
        children:["hello world!"]
    }
     */
    function createElement(nodeName,attr,...args){
        return {nodeName:nodeName,attr:attr,children:[].concat(...args)}
    }
    function render(vnode){
        //如果是文本
        if(vnode.split){
            return document.createTextNode(vnode);
        }
        //如果不是文本
        let node=document.createElement(vnode.nodeName);

        //添加属性
        let attr=vnode.attr || {};
        Object.keys(attr).forEach((k)=>{
            node.setAttribute(k,attr[k]);
        });

        //添加子节点
        (vnode.children || []).forEach((n)=>{
            node.appendChild(render(n))
        });
        return node;
    }
    let dom=render(vDom);
    document.body.appendChild(dom);
</script>
</body>
</html>