<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no"/>
    <title>jsx实现虚拟dom</title>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!--<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>-->
    <!--<script src="js/babel.min.js"></script>-->
</head>
<body>
<div id="output"></div>
<script>
    function demo(){
        //console.log(arguments);
        //console.log(Array.prototype.slice.call(arguments));
        console.log(Array.from(arguments));
    }
    demo(1,2,3,4);
</script>
<script type="text/babel">

    /*@jsx createElement*/
    let vDom=(<div id='app'>
        Hello World!
        <ul>
            <li>张三</li>
            <li>李四</li>
        </ul>
    </div>)
    /**
   将真实的dom转成虚拟dom，json格式开销小，性能高
   {
       nodeName:div,
       attr:{
           id:"app"
       },
       children:["hello world!"]
   }
    */
    function createElement(nodeName,attr,...args){
        console.log({nodeName:nodeName,attr:attr,children:[].concat(...args)});
        return {nodeName:nodeName,attr:attr,children:[].concat(...args)}
    }

    function render(vnode){
        //如果是文本
        if(vnode.split){
            return document.createTextNode(vnode);
        }
        //如果不是文本
        let node=document.createElement(vnode.nodeName);

        //添加属性
        let attr=vnode.attr || {};
        Object.keys(attr).forEach((k)=>{
            node.setAttribute(k,attr[k]);
        });

        //添加子节点
        (vnode.children || []).forEach((n)=>{
            node.appendChild(render(n))
        });
        return node;
    }
    let dom=render(vDom);
    document.body.appendChild(dom);

</script>
</body>
</html>